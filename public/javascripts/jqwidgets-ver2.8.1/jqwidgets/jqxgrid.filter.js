/*
jQWidgets v2.8.1 (2013-Apr-12)
Copyright (c) 2011-2013 jQWidgets.
License: http://jqwidgets.com/license/
*/

(function(a){a.extend(a.jqx._jqxGrid.prototype,{_updatefilterrowui:function(f){var l=this.columns.records.length;var e=0;for(var h=0;h<l;h++){var g=this.columns.records[h];var c=g.width;if(c<g.minwidth){c=g.minwidth}if(c>g.maxwidth){c=g.maxwidth}var k=a(this.filterrow[0].cells[h]);k.css("left",e);var i=true;if(k.width()==c){i=false}if(f){i=true}k.width(c);k[0].left=e;if(!(g.hidden&&g.hideable)){e+=c}else{k.css("display","none")}if(!i){continue}if(g.createfilterwidget&&g.filtertype=="custom"){g.createfilterwidget(g,k)}else{if(g.filterable){var d=function(m,n){var j=a(n.children()[0]);j.width(c-10)};switch(g.filtertype){case"number":a(k.children()[0]).width(c);k.find("input").width(c-30);break;case"date":if(this.host.jqxDateTimeInput){a(k.children()[0]).jqxDateTimeInput({width:c-10})}else{d(this,k)}break;case"textbox":case"default":d(this,k);break;case"list":case"checkedlist":if(this.host.jqxDropDownList){a(k.children()[0]).jqxDropDownList({width:c-10})}else{d(this,k)}break;case"bool":case"boolean":if(!this.host.jqxCheckBox){d(this,k)}break}}}}var b=a(this.filterrow.children()[0]);b.width(parseInt(e)+2);b.height(this.filterrowheight)},clearfilterrow:function(){this._disablefilterrow=true;var b=this.columns.records.length;var f=0;for(var d=0;d<b;d++){var c=this.columns.records[d];var g=a(this.filterrow[0].cells[d]);if(c.filterable){var e=function(i,j){var h=a(j.children()[0]);h.val("");if(h[0]){i["_oldWriteText"+h[0].id]=""}};switch(c.filtertype){case"number":g.find("input").val("");break;case"date":if(this.host.jqxDateTimeInput){a(g.children()[0]).jqxDateTimeInput("setDate",null)}else{e(this,g)}break;case"textbox":case"default":e(this,g);break;case"list":if(this.host.jqxDropDownList){a(g.children()[0]).jqxDropDownList("clearSelection")}else{e(this,g)}break;case"checkedlist":if(this.host.jqxDropDownList){a(g.children()[0]).jqxDropDownList("checkAll",false)}else{e(this,g)}break;case"bool":case"boolean":if(!this.host.jqxCheckBox){e(this,g)}else{a(g.children()[0]).jqxCheckBox({checked:null})}break}}}this._disablefilterrow=false},_applyfilterfromfilterrow:function(){if(this._disablefilterrow==true){return}var z=this.columns.records.length;var C=this;for(var t=0;t<z;t++){var k=new a.jqx.filter();var u=this.columns.records[t];if(!u.filterable){continue}var f=C._getcolumntypebydatafield(u);var d=C._getfiltertype(f);var l=1;var D=true;var e=u.filtertype;var A=function(j,K,H){var i=true;if(j._filterwidget){var F=j._filterwidget.val();if(F!=""){var I="equal";if(K=="stringfilter"){var I="contains"}if(K!="stringfilter"){var J=0;if(F.indexOf(">")!=-1){I="greater_than";J=1}if(F.indexOf("<")!=-1){I="less_than";J=1}if(F.indexOf("=")!=-1){if(I=="greater_than"){I="greater_than_or_equal";J=2}else{if(I=="less_than"){I="less_than_or_equal";J=2}else{I="equal";J=1}}}if(J!=0){F=F.substring(J);if(F.length<1){return false}}}if(j.filtercondition!=undefined){I=j.filtercondition}var G=H.createfilter(K,F,I);H.addfilter(l,G)}else{i=false}}return i};switch(u.filtertype){case"date":if(u._filterwidget.jqxDateTimeInput){var p=u._filterwidget.jqxDateTimeInput("getRange");if(p!=null&&p.from!=null&&p.to!=null){var o="GREATER_THAN_OR_EQUAL";var r=new Date(0);r.setHours(0);r.setFullYear(p.from.getFullYear(),p.from.getMonth(),p.from.getDate());var q=new Date(0);q.setHours(0);q.setFullYear(p.to.getFullYear(),p.to.getMonth(),p.to.getDate());q.setHours(p.to.getHours());q.setMinutes(p.to.getMinutes());q.setSeconds(p.to.getSeconds());var y=k.createfilter(d,r,o);k.addfilter(0,y);var c="LESS_THAN_OR_EQUAL";var x=k.createfilter(d,q,c);k.addfilter(0,x)}else{D=false}}else{D=A(u,d,k)}break;case"number":if(u._filterwidget){var p=u._filterwidget.find("input").val();var h=u._filterwidget.find(".filter").jqxDropDownList("selectedIndex");var w=k.getoperatorsbyfiltertype(d)[h];if(C.updatefilterconditions){var E=C.updatefilterconditions(d,k.getoperatorsbyfiltertype(d));if(E!=undefined){k.setoperatorsbyfiltertype(d,E)}var w=k.getoperatorsbyfiltertype(d)[h]}var n=w=="NULL"||w=="NOT_NULL";var s=w=="EMPTY"||w=="NOT_EMPTY";if(p!=undefined&&p.length>0||n||s){y=k.createfilter(d,p,w,null,u.cellsformat,C.gridlocalization);k.addfilter(0,y)}else{D=false}}else{D=false}break;case"textbox":case"default":D=A(u,d,k);break;case"bool":case"boolean":if(u._filterwidget.jqxCheckBox){var p=u._filterwidget.jqxCheckBox("checked");if(p!=null){var o="equal";var m=k.createfilter(d,p,o);k.addfilter(l,m)}else{D=false}}else{D=A(u,d,k)}break;case"list":var g=u._filterwidget.jqxDropDownList("listBox");if(g.selectedIndex>0){var b=g.getItem(g.selectedIndex);var p=b.value;var o="equal";var m=k.createfilter(d,p,o);k.addfilter(l,m)}else{D=false}break;case"checkedlist":if(u._filterwidget.jqxDropDownList){var g=u._filterwidget.jqxDropDownList("listBox");var B=g.getCheckedItems();if(B.length==0){for(var v=1;v<g.items.length;v++){var p=g.items[v].value;var o="not_equal";var m=k.createfilter(d,p,o);k.addfilter(0,m)}D=true}else{if(B.length!=g.items.length){for(var v=0;v<B.length;v++){var p=B[v].value;var o="equal";var m=k.createfilter(d,p,o);k.addfilter(l,m)}}else{D=false}}}else{D=A(u,d,k)}break}if(!this._loading){if(D){this.addfilter(u.displayfield,k,false)}else{this.removefilter(u.displayfield,false)}}}if(!this._loading){this.applyfilters("filterrow")}},_updatefilterrow:function(){var b=a('<div style="position: relative;" id="row00'+this.element.id+'"></div>');var f=0;var o=this.columns.records.length;var m=this.toThemeProperty("jqx-grid-cell");m+=" "+this.toThemeProperty("jqx-grid-cell-pinned");var q=o+10;var r=new Array();var n=this;this.filterrow[0].cells=r;b.height(this.filterrowheight);this.filterrow.children().detach();this.filterrow.append(b);if(!this._filterrowcache){this._filterrowcache=new Array()}var g=false;var d=new Array();for(var h=0;h<o;h++){var e=this.columns.records[h];var c=e.width;if(c<e.minwidth){c=e.minwidth}if(c>e.maxwidth){c=e.maxwidth}var l=a('<div style="overflow: hidden; position: absolute; height: 100%;" class="'+m+'"></div>');b.append(l);l.css("left",f);if(this.rtl){l.css("z-index",q++);l.css("border-left-width","1px")}else{l.css("z-index",q--)}l.width(c);l[0].left=f;if(!(e.hidden&&e.hideable)){f+=c}else{l.css("display","none")}r[r.length]=l[0];var k=true;if(this.groupable){var p=this.rowdetails?1:0;if(this.groups.length+p>h){k=false}}if(this.rowdetails&&h==0){k=false}if(k){if(e.filtertype=="custom"&&e.createfilterwidget){var i=function(){n._applyfilterfromfilterrow()};e.createfilterwidget(e,l,i)}else{if(e.filterable){if(this._filterrowcache[e.datafield]){g=true;l.append(this._filterrowcache[e.datafield]);e._filterwidget=this._filterrowcache[e.datafield]}else{this._addfilterwidget(e,l,c);d[e.datafield]=e._filterwidget}}}}}this._filterrowcache=d;if(a.jqx.browser.msie&&a.jqx.browser.version<8){b.css("z-index",q--)}b.width(parseInt(f)+2);this.filterrow.addClass(m);this.filterrow.css("border-top-width","1px");if(g){this._updatefilterrowui(true)}},_addfilterwidget:function(z,d,x){var C=this;var w="";for(var A=0;A<C.dataview.filters.length;A++){var u=C.dataview.filters[A];if(u.datafield&&u.datafield==z.datafield){w=u.filter.getfilters()[0].value;break}}var g=function(D,E){var f=a('<input autocomplete="off" type="textarea"/>');f[0].id=a.jqx.utilities.createId();f.addClass(D.toThemeProperty("jqx-widget"));f.addClass(D.toThemeProperty("jqx-input"));f.addClass(D.toThemeProperty("jqx-widget-content"));if(D.rtl){f.css("direction","rtl")}f.appendTo(E);f.width(x-10);f.height(D.filterrowheight-10);f.css("margin","4px");if(z.createfilterwidget){z.createfilterwidget(z,E,f)}z._filterwidget=f;f.focus(function(){D.focusedfilter=f;f.addClass(D.toThemeProperty("jqx-fill-state-focus"))});f.blur(function(){f.removeClass(D.toThemeProperty("jqx-fill-state-focus"))});f.keydown(function(F){if(F.keyCode=="13"){D._applyfilterfromfilterrow()}if(f[0]._writeTimer){clearTimeout(f[0]._writeTimer)}f[0]._writeTimer=setTimeout(function(){if(!D._loading){if(D["_oldWriteText"+f[0].id]!=f.val()){D._applyfilterfromfilterrow();D["_oldWriteText"+f[0].id]=f.val()}}},400);D.focusedfilter=f});D.host.removeClass("jqx-disableselect");D.content.removeClass("jqx-disableselect");f.val(w)};switch(z.filtertype){case"number":var k=a("<div></div>");k.width(d.width());k.height(this.filterrowheight);d.append(k);var x=d.width()-20;var p=function(E,F,f){var D=a('<input style="float: left;" autocomplete="off" type="textarea"/>');if(C.rtl){D.css("float","right");D.css("direction","rtl")}D[0].id=a.jqx.utilities.createId();D.addClass(C.toThemeProperty("jqx-widget"));D.addClass(C.toThemeProperty("jqx-input"));D.addClass(C.toThemeProperty("jqx-widget-content"));D.appendTo(E);D.width(F-10);D.height(C.filterrowheight-10);D.css("margin","4px");D.css("margin-right","2px");D.focus(function(){C.focusedfilter=D;D.addClass(C.toThemeProperty("jqx-fill-state-focus"))});D.blur(function(){D.removeClass(C.toThemeProperty("jqx-fill-state-focus"))});D.keydown(function(G){if(G.keyCode=="13"){C._applyfilterfromfilterrow()}if(D[0]._writeTimer){clearTimeout(D[0]._writeTimer)}D[0]._writeTimer=setTimeout(function(){if(!C._loading){if(C["_oldWriteText"+D[0].id]!=D.val()){C._applyfilterfromfilterrow();C["_oldWriteText"+D[0].id]=D.val()}}},400);C.focusedfilter=D});D.val(w);return D};p(k,x);var y=C._getfiltersbytype("number");var q=a("<div class='filter' style='float: left;'></div>");q.css("margin-top","4px");q.appendTo(k);if(C.rtl){q.css("float","right")}var h=2;if(z.filtercondition!=null){var e=y.indexOf(z.filtercondition);if(e!=-1){h=e}}q.jqxDropDownList({rtl:C.rtl,dropDownHorizontalAlignment:"right",enableBrowserBoundsDetection:true,selectedIndex:h,width:18,height:20,dropDownHeight:150,dropDownWidth:170,source:y,theme:C.theme});q.jqxDropDownList({selectionRenderer:function(f){return""}});q.jqxDropDownList("setContent","");q.find(".jqx-dropdownlist-content").hide();if(z.createfilterwidget){z.createfilterwidget(z,d,k)}z._filterwidget=k;this.addHandler(q,"select",function(){if(z._filterwidget.find("input").val().length>0&&!C.refreshingfilter){C._applyfilterfromfilterrow()}});break;case"textbox":case"default":default:g(this,d);break;case"none":break;case"date":if(this.host.jqxDateTimeInput){var b=a("<div></div>");b.css("margin","4px");b.appendTo(d);var l={calendar:this.gridlocalization,todayString:this.gridlocalization.todaystring,clearString:this.gridlocalization.clearstring};b.jqxDateTimeInput({localization:l,rtl:C.rtl,showFooter:true,formatString:z.cellsformat,selectionMode:"range",value:null,theme:this.theme,width:x-10,height:this.filterrowheight-10});if(z.createfilterwidget){z.createfilterwidget(z,d,b)}z._filterwidget=b;this.addHandler(b,"valuechanged",function(f){if(!C.refreshingfilter){C._applyfilterfromfilterrow();C.focusedfilter=null}})}else{g(this,d)}break;case"list":case"checkedlist":if(this.host.jqxDropDownList){var o=this._getfilterdataadapter(z);var j=true;var q=a("<div></div>");q.css("margin","4px");var r=z.datafield;var s=z.filtertype=="checkedlist"?true:false;q.jqxDropDownList({rtl:C.rtl,checkboxes:s,source:o,autoDropDownHeight:j,theme:this.theme,width:x-10,height:this.filterrowheight-10,displayMember:z.displayfield,valueMember:r});q.appendTo(d);var n=q.jqxDropDownList("getItems");var c=q.jqxDropDownList("listBox");if(n.length<8){q.jqxDropDownList("autoDropDownHeight",true)}else{q.jqxDropDownList("autoDropDownHeight",false);j=false}if(s){q.jqxDropDownList({selectionRenderer:function(){return C.gridlocalization.filterselectstring}});var v=a('<span style="top: 2px; position: relative; color: inherit; border: none; background-color: transparent;">'+C.gridlocalization.filterselectstring+"</span>");v.addClass(this.toThemeProperty("jqx-item"));if(c!=undefined){if(!j){c.host.height(200)}c.insertAt(C.gridlocalization.filterselectallstring,0);q.jqxDropDownList("setContent",v);var i=true;var B=new Array();c.checkAll(false);C.addHandler(c.host,"checkChange",function(E){q[0]._selectionChanged=true;if(!i){return}if(E.args.label!=C.gridlocalization.filterselectallstring){i=false;c.host.jqxListBox("checkIndex",0,true,false);var f=c.host.jqxListBox("getCheckedItems");var D=c.host.jqxListBox("getItems");if(f.length==1){c.host.jqxListBox("uncheckIndex",0,true,false)}else{if(D.length!=f.length){c.host.jqxListBox("indeterminateIndex",0,true,false)}}i=true}else{i=false;if(E.args.checked){c.host.jqxListBox("checkAll",false)}else{c.host.jqxListBox("uncheckAll",false)}i=true}})}}else{c.insertAt({label:this.gridlocalization.filterchoosestring,value:""},0);q.jqxDropDownList({selectedIndex:0})}if(z.createfilterwidget){z.createfilterwidget(z,d,q)}z._filterwidget=q;var m=q.jqxDropDownList("dropdownlistWrapper");if(z.filtertype=="list"){this.addHandler(q,"select",function(f){if(!C.refreshingfilter){if(f.args&&f.args.type!="none"){C._applyfilterfromfilterrow();C.focusedfilter=null}}})}else{this.addHandler(q,"close",function(f){if(q[0]._selectionChanged){C._applyfilterfromfilterrow();C.focusedfilter=null;q[0]._selectionChanged=false}})}}else{g(this,d)}break;case"bool":case"boolean":if(this.host.jqxCheckBox){var t=a('<div tabIndex=0 style="opacity: 0.99; position: absolute; top: 50%; left: 50%; margin-top: -7px; margin-left: -10px;"></div>');t.appendTo(d);t.jqxCheckBox({enableContainerClick:false,animationShowDelay:0,animationHideDelay:0,hasThreeStates:true,theme:this.theme,checked:null});if(z.createfilterwidget){z.createfilterwidget(z,d,t)}if(w===true||w=="true"){t.jqxCheckBox({checked:true})}else{if(w===false||w=="false"){t.jqxCheckBox({checked:false})}}z._filterwidget=t;this.addHandler(t,"change",function(f){if(!C.refreshingfilter){if(f.args){C.focusedfilter=null;C._applyfilterfromfilterrow()}}})}else{g(this,d)}break}},_getfilterdataadapter:function(b){var c=this.source._source?true:false;if(!c){dataadapter=new a.jqx.dataAdapter(this.source,{autoBind:false,uniqueDataFields:[b.displayfield],autoSort:true,autoSortField:b.displayfield,async:false})}else{var d={localdata:this.source.records,datatype:this.source.datatype,async:false};dataadapter=new a.jqx.dataAdapter(d,{autoBind:false,autoSort:true,autoSortField:b.displayfield,async:false,uniqueDataFields:[b.displayfield]})}if(b.filteritems&&b.filteritems.length>0){var d={localdata:b.filteritems,datatype:this.source.datatype,async:false};dataadapter=new a.jqx.dataAdapter(d,{autoBind:false,async:false})}return dataadapter},refreshfilterrow:function(){if(!this.showfilterrow){return}this.refreshingfilter=true;this._updatefilterrowui();this._updatelistfilters();var h=this;var l=this.columns.records.length;for(var d=0;d<l;d++){var c=this.columns.records[d];if(c.filterable){if(c.filter){var b=c.filter.getfilters();if(b.length>0){var k=b[0].value;var e=c._filterwidget;var f=c._filterwidget.parent();if(e!=null){switch(c.filtertype){case"number":f.find("input").val(k);if(this.host.jqxDropDownList){var i=c.filter.getoperatorsbyfiltertype("numericfilter");e.find(".filter").jqxDropDownList("selectIndex",i.indexOf(b[0].condition))}break;case"date":if(this.host.jqxDateTimeInput){var k=c.filter.getfilterat(0).filtervalue;if(k!=undefined){if(c.filter.getfilterat(1)){var g=c.filter.getfilterat(1).filtervalue}else{g=k}a(f.children()[0]).jqxDateTimeInput("setRange",new Date(k),new Date(g))}}else{e.val(k)}break;case"textbox":case"default":e.val(k);h["_oldWriteText"+e[0].id]=k;break;case"bool":case"boolean":if(!this.host.jqxCheckBox){e.val(k)}else{a(f.children()[0]).jqxCheckBox({checked:k})}break}}}}}}this.refreshingfilter=false},_destroyedfilters:function(){var g=this;var b=this.columns.records.length;for(var f=0;f<b;f++){var c=this.columns.records[f];if(c.filterable){var h=c._filterwidget;if(c.filtertype=="list"||c.filtertype=="checkedlist"){this.removeHandler(h,"select");this.removeHandler(h,"close");h.jqxDropDownList("destroy")}else{if(c.filtertype=="date"){this.removeHandler(h,"valuechanged");h.jqxDateTimeInput("destroy")}else{if(c.filtertype=="bool"){this.removeHandler(h,"change");h.jqxCheckBox("destroy")}else{if(c.filtertype=="number"){var d=h.find(".jqx-input");this.removeHandler(d,"keydown");var e=a(h.children()[1]);e.jqxDropDownList("destroy")}else{this.removeHandler(h,"keydown")}}}}h.remove()}}},_updatelistfilters:function(o){var p=this;var s=this.columns.records.length;for(var k=0;k<s;k++){var f=this.columns.records[k];if(f.filterable){if(f.filtertype=="list"||f.filtertype=="checkedlist"){var n=f._filterwidget;if(!o){if(f.filter==undefined){n.jqxDropDownList("renderSelection");continue}}else{var b=this._getfilterdataadapter(f);b.dataBind();var h=n.jqxDropDownList("getItems");var t=true;if(h.length!=b.records.length+1){t=false}if(t){for(var l=1;l<h.length;l++){if(h[l].label!=b.records[l-1][f.displayfield]){t=false;break}}}if(t){continue}}n.jqxDropDownList("dataBind");var m=f.filtertype=="checkedlist"?true:false;var h=n.jqxDropDownList("getItems");var c=n.jqxDropDownList("listBox");if(m){n.jqxDropDownList({selectionRenderer:function(){return p.gridlocalization.filterselectstring}});var e=a('<span style="top: 2px; position: relative; color: inherit; border: none; background-color: transparent;">'+this.gridlocalization.filterselectstring+"</span>");e.addClass(this.toThemeProperty("jqx-item"));c.insertAt(this.gridlocalization.filterselectallstring,0);n.jqxDropDownList("setContent",e);c.checkAll(false);if(f.filter){c.uncheckAll(false);var d=f.filter.getfilters();for(var l=0;l<c.items.length;l++){var r=c.items[l].label;a.each(d,function(){if(this.condition=="NOT_EQUAL"){return true}if(r==this.value){c.checkIndex(l,false,false)}})}c._updateCheckedItems();var q=c.getCheckedItems().length;if(c.items.length!=q&&q>0){c.host.jqxListBox("indeterminateIndex",0,true,false)}}}else{c.insertAt({label:this.gridlocalization.filterchoosestring,value:""},0);n.jqxDropDownList({selectedIndex:0});if(f.filter){var d=f.filter.getfilters();var g=-1;for(var l=0;l<c.items.length;l++){var r=c.items[l].label;a.each(d,function(){if(this.condition=="NOT_EQUAL"){return true}if(r==this.value){g=l;return false}})}if(g!=-1){c.selectIndex(g)}}}if(h.length<8){n.jqxDropDownList("autoDropDownHeight",true)}else{n.jqxDropDownList("autoDropDownHeight",false)}}}}},_renderfiltercolumn:function(){var b=this;if(this.filterable){a.each(this.columns.records,function(c,d){if(b.autoshowfiltericon){if(this.filter){a(this.filtericon).show()}else{a(this.filtericon).hide()}}else{if(this.filterable){a(this.filtericon).show()}}})}},_getcolumntypebydatafield:function(f){var g=this;var e="string";var d=g.source.datafields||((g.source._source)?g.source._source.datafields:null);if(d){var i="";a.each(d,function(){if(this.name==f.displayfield){if(this.type){i=this.type}return false}});if(i){return i}}if(f!=null){if(this.dataview.cachedrecords==undefined){return e}var b=null;if(!this.virtualmode){if(this.dataview.cachedrecords.length==0){return e}b=this.dataview.cachedrecords[0][f.displayfield];if(b!=null&&b.toString()==""){return"string"}}else{a.each(this.dataview.cachedrecords,function(){b=this[f.displayfield];return false})}if(b!=null){if(typeof b=="boolean"){e="boolean"}else{if(a.jqx.dataFormat.isNumber(b)){e="number"}else{var h=new Date(b);if(h.toString()=="NaN"||h.toString()=="Invalid Date"){if(a.jqx.dataFormat){h=a.jqx.dataFormat.tryparsedate(b);if(h!=null){if(h&&h.getFullYear()){if(h.getFullYear()==1970&&h.getMonth()==0&&h.getDate()==1){var c=new Number(b);if(!isNaN(c)){return"number"}return"string"}}return"date"}else{e="string"}}else{e="string"}}else{e="date"}}}}}return e},_getfiltersbytype:function(b){var c=this;var d="";switch(b){case"number":case"float":case"int":d=c.gridlocalization.filternumericcomparisonoperators;break;case"date":d=c.gridlocalization.filterdatecomparisonoperators;break;case"boolean":case"bool":d=c.gridlocalization.filterbooleancomparisonoperators;break;case"string":default:d=c.gridlocalization.filterstringcomparisonoperators;break}return d},_updatefilterpanel:function(z,c,d){if(z==null||z==undefined){z=this}var e=z._getcolumntypebydatafield(d);var u=z._getfiltersbytype(e);if(!z.host.jqxDropDownList){throw new Error("jqxGrid: Missing reference to jqxdropdownlist.js.");return}var s=a(c);var o=s.find("#filterclearbutton"+z.element.id);var i=s.find("#filterbutton"+z.element.id);var w=s.find("#filter1"+z.element.id);var t=s.find("#filter2"+z.element.id);var v=s.find("#filter3"+z.element.id);var r=s.find(".filtertext1"+z.element.id);var q=s.find(".filtertext2"+z.element.id);r.val("");q.val("");this.removeHandler(i,"click");this.addHandler(i,"click",function(){z._buildfilter(z,c,d);z._closemenu()});this.removeHandler(o,"click");this.addHandler(o,"click",function(){z._clearfilter(z,c,d);z._closemenu()});if(w.jqxDropDownList("source")!=u){w.jqxDropDownList({enableBrowserBoundsDetection:false,source:u});v.jqxDropDownList({enableBrowserBoundsDetection:false,source:u})}if(e=="boolean"||e=="bool"){w.jqxDropDownList({autoDropDownHeight:true,selectedIndex:0});v.jqxDropDownList({autoDropDownHeight:true,selectedIndex:0})}else{var f=false;if(u&&u.length){if(u.length<5){f=true}}w.jqxDropDownList({autoDropDownHeight:f,selectedIndex:2});v.jqxDropDownList({autoDropDownHeight:f,selectedIndex:2})}t.jqxDropDownList({selectedIndex:0});var m=d.filter;if(m!=null){var y=m.getfilterat(0);var x=m.getfilterat(1);var l=m.getoperatorat(0);var j=[];var b="";switch(e){case"number":case"int":case"float":case"decimal":b="numericfilter";j=m.getoperatorsbyfiltertype("numericfilter");break;case"boolean":case"bool":b="booleanfilter";j=m.getoperatorsbyfiltertype("booleanfilter");break;case"date":case"time":b="datefilter";j=m.getoperatorsbyfiltertype("datefilter");break;case"string":b="stringfilter";j=m.getoperatorsbyfiltertype("stringfilter");break}if(z.updatefilterconditions){var A=z.updatefilterconditions(b,j);if(A!=undefined){m.setoperatorsbyfiltertype(b,A);j=A}}var k=this.enableanimations?"default":"none";if(y!=null){var h=j.indexOf(y.comparisonoperator);var p=y.filtervalue;r.val(p);w.jqxDropDownList({selectedIndex:h,animationType:k})}if(x!=null){var g=j.indexOf(x.comparisonoperator);var n=x.filtervalue;q.val(n);v.jqxDropDownList({selectedIndex:g,animationType:k})}if(m.getoperatorat(0)==undefined){t.jqxDropDownList({selectedIndex:0,animationType:k})}else{if(m.getoperatorat(0)=="and"||m.getoperatorat(0)==0){t.jqxDropDownList({selectedIndex:0})}else{t.jqxDropDownList({selectedIndex:1})}}}if(z.updatefilterpanel){z.updatefilterpanel(w,v,t,r,q,i,o,m,b,j)}r.focus();setTimeout(function(){r.focus()},10)},_getfiltertype:function(b){var c="stringfilter";switch(b){case"number":case"int":case"float":case"decimal":c="numericfilter";break;case"boolean":case"bool":c="booleanfilter";break;case"date":case"time":c="datefilter";break;case"string":c="stringfilter";break}return c},_buildfilter:function(A,d,e){var x=a(d).find("#filter1"+A.element.id);var j=a(d).find("#filter2"+A.element.id);var u=a(d).find("#filter3"+A.element.id);var q=a(d).find(".filtertext1"+A.element.id);var p=a(d).find(".filtertext2"+A.element.id);var o=q.val();var m=p.val();var f=A._getcolumntypebydatafield(e);var r=A._getfiltersbytype(f);var h=x.jqxDropDownList("selectedIndex");var w=j.jqxDropDownList("selectedIndex");var g=u.jqxDropDownList("selectedIndex");var i=new a.jqx.filter();var z=null;var y=null;var c=A._getfiltertype(f);if(A.updatefilterconditions){var B=A.updatefilterconditions(c,i.getoperatorsbyfiltertype(c));if(B!=undefined){i.setoperatorsbyfiltertype(c,B)}}var b=false;var v=i.getoperatorsbyfiltertype(c)[h];var u=i.getoperatorsbyfiltertype(c)[g];var n=v=="NULL"||v=="NOT_NULL";var t=v=="EMPTY"||v=="NOT_EMPTY";if(v==undefined){v=i.getoperatorsbyfiltertype(c)[0]}if(u==undefined){u=i.getoperatorsbyfiltertype(c)[0]}if(o.length>0||n||t){z=i.createfilter(c,o,v,null,e.cellsformat,A.gridlocalization);i.addfilter(w,z);b=true}var l=u=="NULL"||u=="NOT_NULL";var s=u=="EMPTY"||u=="NOT_EMPTY";if(m.length>0||l||s){y=i.createfilter(c,m,u,null,e.cellsformat,A.gridlocalization);i.addfilter(w,y);b=true}if(b){var k=e.displayfield;this.addfilter(k,i,true)}else{this._clearfilter(A,d,e)}},_clearfilter:function(e,c,d){var b=d.displayfield;this.removefilter(b,true)},addfilter:function(d,e,c){if(this._loading){throw new Error("jqxGrid: "+this.loadingerrormessage);return false}var f=this.getcolumn(d);var b=this._getcolumn(d);if(f==undefined||f==null){return}f.filter=e;b.filter=e;this.dataview.addfilter(d,e);if(c==true&&c!=undefined){this.applyfilters("add")}},removefilter:function(d,c){if(this._loading){throw new Error("jqxGrid: "+this.loadingerrormessage);return false}var e=this.getcolumn(d);var b=this._getcolumn(d);if(e==undefined||e==null){return}if(e.filter==null){return}this.dataview.removefilter(d,e.filter);e.filter=null;b.filter=null;if(c==true||c!=undefined){this.applyfilters("remove")}},applyfilters:function(g){var c=false;if(this.dataview.filters.length>=0&&(this.virtualmode||!this.source.localdata)){if(this.source!=null&&this.source.filter){var h=-1;if(this.pageable){h=this.dataview.pagenum;this.dataview.pagenum=0}else{this.vScrollInstance.setPosition(0)}this.source.filter(this.dataview.filters,this.dataview.records,this.dataview.records.length);if(this.pageable){this.dataview.pagenum=h}}}if(this.dataview.clearsortdata){this.dataview.clearsortdata()}if(!this.virtualmode){var b=this.selectedrowindexes;var d=this;if(b.length>0){if(this.dataview.filters&&this.dataview.filters.length==0){var e=new Array();a.each(b,function(){var i=d.getrowdata(this);if(i&&i.dataindex){e[e.length]=i.dataindex}});this.selectedrowindexes=e;this.selectedrowindex=this.selectedrowindexes.length>0?this.selectedrowindexes[0]:-1}}this.dataview.refresh();if(b.length>0){if(this.dataview.filters&&this.dataview.filters.length>0){var e=new Array();a.each(b,function(){var i=d.dataview._dataIndexToBoundIndex[this];if(i!=null){e[e.length]=i.boundindex}});this.selectedrowindexes=e;this.selectedrowindex=this.selectedrowindexes.length>0?this.selectedrowindexes[0]:-1}}if(this.dataview.clearsortdata){if(this.sortcolumn&&this.sortdirection){var f=this.sortdirection.ascending?"asc":"desc";this.sortby(this.sortcolumn,f,null,false)}}}else{if(this.pageable){this.dataview.updateview();if(this.gotopage){this.gotopage(0)}}this.rendergridcontent(false,false);this._raiseEvent(13,{filters:this.dataview.filters});return}if(this.pageable){this.dataview.updateview();if(this.gotopage){this.gotopage(0);this.updatepagerdetails()}}this._updaterowsproperties();if(!this.groupable||(this.groupable&&this.groups.length==0)){this._rowdetailscache=new Array();this.virtualsizeinfo=null;this._pagescache=new Array();if(this.columns&&this.columns.records&&this.columns.records.length>0&&!this.columns.records[0].filtericon){this.prerenderrequired=true}this.rendergridcontent(true,true);this._updatecolumnwidths();this._updatecellwidths();this._renderrows(this.virtualsizeinfo);if(this.showaggregates&&this._updatecolumnsaggregates){this._updatecolumnsaggregates()}}else{this._rowdetailscache=new Array();this._render(true,true,false,false,false);if(this.showfilterrow){this._updatefocusedfilter()}this._updatecolumnwidths();this._updatecellwidths();this._renderrows(this.virtualsizeinfo)}if(this.showfilterrow){if(typeof g!="string"&&a.isEmptyObject(g)){this.refreshfilterrow()}}this._raiseEvent(13,{filters:this.dataview.filters})},getfilterinformation:function(){var d=new Array();for(var b=0;b<this.dataview.filters.length;b++){var c=this.getcolumn(this.dataview.filters[b].datafield);d[b]={filter:this.dataview.filters[b].filter,filtercolumn:c.datafield,filtercolumntext:c.text}}return d},clearfilters:function(b){var c=this;if(this.showfilterrow){this.clearfilterrow()}if(this.columns.records){a.each(this.columns.records,function(){c.removefilter(this.displayfield)})}if(b===false){return}if(b==true||b!=undefined){this.applyfilters("clear")}},_destroyfilterpanel:function(){var e=a(a.find("#filterclearbutton"+this.element.id));var d=a(a.find("#filterbutton"+this.element.id));var h=a(a.find("#filter1"+this.element.id));var c=a(a.find("#filter2"+this.element.id));var g=a(a.find("#filter3"+this.element.id));var f=a(a.find(".filtertext1"+this.element.id));var b=a(a.find(".filtertext2"+this.element.id));if(f.length>0&&b.length>0){f.removeClass();b.removeClass();f.remove();b.remove()}if(e.length>0){e.jqxButton("destroy");d.jqxButton("destroy");this.removeHandler(e,"click");this.removeHandler(d,"click")}if(h.length>0){h.jqxDropDownList("destroy")}if(c.length>0){c.jqxDropDownList("destroy")}if(g>0){g.jqxDropDownList("destroy")}},_initfilterpanel:function(u,b,c,m){if(u==null||u==undefined){u=this}b[0].innerHTML="";var q=a("<div class='filter' style='margin-left: 7px;'></div>");b.append(q);var l=a("<div class='filter' style='margin-top: 3px; margin-bottom: 3px;'></div>");l.text(u.gridlocalization.filtershowrowstring);var r=a("<div class='filter' id='filter1"+u.element.id+"'></div>");var g=a("<div class='filter' id='filter2"+u.element.id+"' style='margin-bottom: 3px;'></div>");var p=a("<div class='filter' id='filter3"+u.element.id+"'></div>");var d=u._getcolumntypebydatafield(c);if(!r.jqxDropDownList){throw new Error("jqxGrid: jqxdropdownlist.js is not loaded.");return}var n=u._getfiltersbytype(d);var i=a("<div class='filter'><input class='filtertext1"+u.element.id+"' style='height: 20px; margin-top: 3px; margin-bottom: 3px;' type='text'></input></div>");var k=i.find("input");k.addClass(this.toThemeProperty("jqx-input"));k.addClass(this.toThemeProperty("jqx-widget-content"));k.addClass(this.toThemeProperty("jqx-rc-all"));k.width(m-15);var j=a("<div class='filter'><input class='filtertext2"+u.element.id+"' style='height: 20px; margin-top: 3px;' type='text'></input></div>");var h=j.find("input");h.addClass(this.toThemeProperty("jqx-input"));h.addClass(this.toThemeProperty("jqx-widget-content"));h.addClass(this.toThemeProperty("jqx-rc-all"));h.width(m-15);if(u.rtl){k.css("direction","rtl");h.css("direction","rtl")}var f=a("<div class='filter' style='height: 25px; margin-left: 20px; margin-top: 7px;'></div>");var e=a('<span tabIndex=0 id="filterbutton'+u.element.id+'" class="filterbutton" style="padding: 4px 12px; margin-left: 2px;">'+u.gridlocalization.filterstring+"</span>");f.append(e);var s=a('<span tabIndex=0 id="filterclearbutton'+u.element.id+'" class="filterclearbutton" style="padding: 4px 12px; margin-left: 5px;">'+u.gridlocalization.filterclearstring+"</span>");f.append(s);e.jqxButton({height:20,theme:u.theme});s.jqxButton({height:20,theme:u.theme});var t=function(w){if(w){if(w.text().indexOf("case sensitive")!=-1){var v=w.text();v=v.replace("case sensitive","match case");w.text(v)}w.css("font-family",u.host.css("font-family"));w.css("font-size",u.host.css("font-size"));return w}return""};q.append(l);q.append(r);r.jqxDropDownList({rtl:u.rtl,enableBrowserBoundsDetection:false,selectedIndex:2,width:m-15,height:20,dropDownHeight:150,dropDownWidth:m-15,selectionRenderer:t,source:n,theme:u.theme});q.append(i);var o=new Array();o[0]=u.gridlocalization.filterandconditionstring;o[1]=u.gridlocalization.filterorconditionstring;g.jqxDropDownList({rtl:u.rtl,enableBrowserBoundsDetection:false,autoDropDownHeight:true,selectedIndex:0,width:60,height:20,source:o,selectionRenderer:t,theme:u.theme});q.append(g);p.jqxDropDownList({rtl:u.rtl,enableBrowserBoundsDetection:false,selectedIndex:2,width:m-15,height:20,dropDownHeight:150,dropDownWidth:m-15,selectionRenderer:t,source:n,theme:u.theme});q.append(p);q.append(j);q.append(f);if(u.updatefilterpanel){u.updatefilterpanel(r,p,g,i,j,e,s,null,null,n)}}});a.jqx.filter=function(){this.operator="and";var h=0;var e=1;var k=["EMPTY","NOT_EMPTY","CONTAINS","CONTAINS_CASE_SENSITIVE","DOES_NOT_CONTAIN","DOES_NOT_CONTAIN_CASE_SENSITIVE","STARTS_WITH","STARTS_WITH_CASE_SENSITIVE","ENDS_WITH","ENDS_WITH_CASE_SENSITIVE","EQUAL","EQUAL_CASE_SENSITIVE","NULL","NOT_NULL"];var m=["EQUAL","NOT_EQUAL","LESS_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN","GREATER_THAN_OR_EQUAL","NULL","NOT_NULL"];var n=["EQUAL","NOT_EQUAL","LESS_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN","GREATER_THAN_OR_EQUAL","NULL","NOT_NULL"];var g=["EQUAL","NOT_EQUAL"];var f=new Array();var l=new Array();this.evaluate=function(s){var q=true;for(var r=0;r<f.length;r++){var p=f[r].evaluate(s);if(r==0){q=p}else{if(l[r]==e||l[r]=="or"){q=q||p}else{q=q&&p}}}return q};this.getfilterscount=function(){return f.length};this.setoperatorsbyfiltertype=function(p,q){switch(p){case"numericfilter":m=q;break;case"stringfilter":k=q;break;case"datefilter":n=q;break;case"booleanfilter":g=q;break}};this.getoperatorsbyfiltertype=function(p){var q=new Array();switch(p){case"numericfilter":q=m.slice(0);break;case"stringfilter":q=k.slice(0);break;case"datefilter":q=n.slice(0);break;case"booleanfilter":q=g.slice(0);break}return q};var j=function(){var p=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(p()+"-"+p()+"-"+p())};this.createfilter=function(t,q,s,r,p,u){if(t==null||t==undefined){return null}switch(t){case"numericfilter":return new i(q,s.toUpperCase());case"stringfilter":return new o(q,s.toUpperCase());case"datefilter":return new c(q,s.toUpperCase(),p,u);case"booleanfilter":return new d(q,s.toUpperCase());case"custom":return new b(q,s.toUpperCase(),r)}throw new Error("jqxGrid: There is no such filter type. The available filter types are: 'numericfilter', 'stringfilter', 'datefilter' and 'booleanfilter'");return null};this.getfilters=function(){var p=new Array();for(var q=0;q<f.length;q++){var r={value:f[q].filtervalue,condition:f[q].comparisonoperator,operator:l[q],type:f[q].type};p[q]=r}return p};this.addfilter=function(p,q){f[f.length]=q;q.key=j();l[l.length]=p};this.removefilter=function(q){for(var p=0;p<f.length;p++){if(f[p].key==q.key){f.splice(p,1);l.splice(p,1);break}}};this.getoperatorat=function(p){if(p==undefined||p==null){return null}if(p<0||p>f.length){return null}return l[p]};this.setoperatorat=function(q,p){if(q==undefined||q==null){return null}if(q<0||q>f.length){return null}l[p]=p};this.getfilterat=function(p){if(p==undefined||p==null){return null}if(p<0||p>f.length){return null}return f[p]};this.setfilterat=function(p,q){if(p==undefined||p==null){return null}if(p<0||p>f.length){return null}q.key=j();f[p]=q};this.clear=function(){f=new Array();l=new Array()};var o=function(q,p){this.filtervalue=q;this.comparisonoperator=p;this.type="stringfilter";this.evaluate=function(u){var t=this.filtervalue;var r=this.comparisonoperator;if(u==null||u==undefined){if(r=="NULL"){return true}return false}var v="";try{v=u.toString()}catch(s){return true}switch(r){case"EQUAL":return a.jqx.string.equalsIgnoreCase(v,t);case"EQUAL_CASE_SENSITIVE":return a.jqx.string.equals(v,t);case"NOT_EQUAL":return !a.jqx.string.equalsIgnoreCase(v,t);case"NOT_EQUAL_CASE_SENSITIVE":return !a.jqx.string.equals(v,t);case"CONTAINS":return a.jqx.string.containsIgnoreCase(v,t);case"CONTAINS_CASE_SENSITIVE":return a.jqx.string.contains(v,t);case"DOES_NOT_CONTAIN":return !a.jqx.string.containsIgnoreCase(v,t);case"DOES_NOT_CONTAIN_CASE_SENSITIVE":return !a.jqx.string.contains(v,t);case"EMPTY":return v=="";case"NOT_EMPTY":return v!="";case"NOT_NULL":return v!=null;case"STARTS_WITH":return a.jqx.string.startsWithIgnoreCase(v,t);case"ENDS_WITH":return a.jqx.string.endsWithIgnoreCase(v,t);case"ENDS_WITH_CASE_SENSITIVE":return a.jqx.string.endsWith(v,t);case"STARTS_WITH_CASE_SENSITIVE":return a.jqx.string.startsWith(v,t);default:return false}}};var d=function(q,p){this.filtervalue=q;this.comparisonoperator=p;this.type="booleanfilter";this.evaluate=function(t){var s=this.filtervalue;var r=this.comparisonoperator;if(t==null||t==undefined){if(r=="NULL"){return true}return false}var u=t;switch(r){case"EQUAL":return u==s||u.toString()==s.toString();case"NOT_EQUAL":return u!=s&&u.toString()!=s.toString();default:return false}}};var i=function(q,p){this.filtervalue=q;this.comparisonoperator=p;this.type="numericfilter";this.evaluate=function(u){var t=this.filtervalue;var r=this.comparisonoperator;if(u==null||u==undefined){if(r=="NOT_NULL"){return false}if(r=="NULL"){return true}else{return false}}else{if(r=="NULL"){return false}if(r=="NOT_NULL"){return true}}var v=u;try{v=parseFloat(v)}catch(s){if(u.toString()!=""){return false}}switch(r){case"EQUAL":return v==t;case"NOT_EQUAL":return v!=t;case"GREATER_THAN":return v>t;case"GREATER_THAN_OR_EQUAL":return v>=t;case"LESS_THAN":return v<t;case"LESS_THAN_OR_EQUAL":return v<=t;case"STARTS_WITH":return a.jqx.string.startsWithIgnoreCase(v.toString(),t.toString());case"ENDS_WITH":return a.jqx.string.endsWithIgnoreCase(v.toString(),t.toString());case"ENDS_WITH_CASE_SENSITIVE":return a.jqx.string.endsWith(v.toString(),t.toString());case"STARTS_WITH_CASE_SENSITIVE":return a.jqx.string.startsWith(v.toString(),t.toString());case"CONTAINS":return a.jqx.string.containsIgnoreCase(v.toString(),t.toString());case"CONTAINS_CASE_SENSITIVE":return a.jqx.string.contains(v.toString(),t.toString());case"DOES_NOT_CONTAIN":return !a.jqx.string.containsIgnoreCase(v.toString(),t.toString());case"DOES_NOT_CONTAIN_CASE_SENSITIVE":return !a.jqx.string.contains(v.toString(),t.toString());default:return true}}};var c=function(s,q,r,v){this.filtervalue=s;this.type="datefilter";if(r!=undefined&&v!=undefined){var t=a.jqx.dataFormat.parsedate(s,r,v);if(t!=null){this.filterdate=t}else{var p=a.jqx.dataFormat.tryparsedate(s,v);if(p!=null){this.filterdate=p}}}else{var u=new Date(s);if(u.toString()=="NaN"||u.toString()=="Invalid Date"){this.filterdate=a.jqx.dataFormat.tryparsedate(s)}else{this.filterdate=u}}this.comparisonoperator=q;this.evaluate=function(D){var E=this.filtervalue;var B=this.comparisonoperator;if(D==null||D==undefined){if(B=="NOT_NULL"){return false}if(B=="NULL"){return true}else{return false}}else{if(B=="NULL"){return false}if(B=="NOT_NULL"){return true}}var w=new Date();w.setFullYear(1900,0,1);w.setHours(12,0,0,0);try{var z=new Date(D);if(z.toString()=="NaN"||z.toString()=="Invalid Date"){D=a.jqx.dataFormat.tryparsedate(D)}else{D=z}w=D}catch(A){if(D.toString()!=""){return false}}if(this.filterdate!=null){E=this.filterdate}else{if(E.indexOf(":")!=-1||!isNaN(parseInt(E))){var C=new Date(w);C.setHours(12,0,0,0);var x=E.split(":");for(var y=0;y<x.length;y++){if(y==0){C.setHours(x[y])}if(y==1){C.setMinutes(x[y])}if(y==2){C.setSeconds(x[y])}}E=C}}if(w==null){w=""}switch(B){case"EQUAL":return w.toString()==E.toString();case"NOT_EQUAL":return w.toString()!=E.toString();case"GREATER_THAN":return w>E;case"GREATER_THAN_OR_EQUAL":return w>=E;case"LESS_THAN":return w<E;case"LESS_THAN_OR_EQUAL":return w<=E;case"STARTS_WITH":return a.jqx.string.startsWithIgnoreCase(w.toString(),E.toString());case"ENDS_WITH":return a.jqx.string.endsWithIgnoreCase(w.toString(),E.toString());case"ENDS_WITH_CASE_SENSITIVE":return a.jqx.string.endsWith(w.toString(),E.toString());case"STARTS_WITH_CASE_SENSITIVE":return a.jqx.string.startsWith(w.toString(),E.toString());case"CONTAINS":return a.jqx.string.containsIgnoreCase(w.toString(),E.toString());case"CONTAINS_CASE_SENSITIVE":return a.jqx.string.contains(w.toString(),E.toString());case"DOES_NOT_CONTAIN":return !a.jqx.string.containsIgnoreCase(w.toString(),E.toString());case"DOES_NOT_CONTAIN_CASE_SENSITIVE":return !a.jqx.string.contains(w.toString(),E.toString());default:return true}}};var b=function(q,p,r){this.filtervalue=q;this.comparisonoperator=p;this.evaluate=function(t,s){return r(this.filtervalue,t,this.comparisonoperator)}}}})(jQuery);